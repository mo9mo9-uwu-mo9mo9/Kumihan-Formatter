# Issue #706: インライン記法の構文曖昧性分析

## 問題の概要

インライン記法（`# キーワード # 内容 ##`）の処理において、文脈によって解釈が異なる曖昧性が存在する。

## 具体的な問題パターン

### 1. 終了マーカーの曖昧性

#### 問題例
```
この段落では、# 太字 # 重要な情報 ## と # イタリック # 補足情報 ## を組み合わせています。
```

**課題**: `##` が以下のどれを意味するか不明確
- インライン記法の終了
- 段落やブロックの終了
- 単なるテキスト

### 2. リスト項目内での処理

#### 現在の記法
```
# リスト #
# 太字 # 新機能A ##
# イタリック # 改良された機能B ##
##
```

**課題**: 
- リスト項目内の `##` がインライン終了かリスト終了か
- インデントとの相互作用

### 3. ブロック内のインライン記法

#### 例
```
# 注意 #
# 太字 # 重要: ## この注意ブロック内でも装飾記法が使用可能です。
##
```

**課題**: ブロック内での `##` の解釈優先順位

### 4. ネストしたインライン記法

#### 可能性のある記法
```
# 太字 # # イタリック # ネスト ## ##
```

**課題**: 
- ネストを許可するか
- 許可する場合の終了マーカー対応関係

### 5. 複数行にまたがるインライン記法

#### 問題例
```
# 太字 # これは長い
テキストで複数行に
またがっています ##
```

**課題**: 改行の扱い

## 提案する解決策

### 方針1: 厳密な文脈解析
- パーサーの状態管理を強化
- 文脈スタックで現在の解析状態を追跡
- 優先順位ルールの明確化

### 方針2: 記法の制限
- インライン記法は単一行内で完結
- ネスト禁止
- リスト項目では特別な終了マーカー

### 方針3: エスケープ機構の導入
- `\##` でリテラルな `##` を表現
- 曖昧性の解消

## 実装優先順位

1. **現状の動作を正確に文書化**
2. **エラーケースの明確化**
3. **段階的な改善実装**
   - Phase 1: エラー検出の改善
   - Phase 2: 警告メッセージの充実
   - Phase 3: 構文の明確化

## テストケース

### 正常系
- 単純なインライン記法
- 複数のインライン記法の連続
- 属性付きインライン記法

### 異常系
- 終了マーカー不足
- ネストしたマーカー
- 複数行にまたがる記法

### エッジケース
- `##` が連続する場合
- 空のインライン記法
- 特殊文字を含む場合

---
*Generated for Issue #706 - インライン記法パースとエラーハンドリング改善*