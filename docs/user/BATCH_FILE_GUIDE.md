;;;見出し1
バッチファイル・コマンドファイル使用ガイド
;;;

;;;太字
ワンクリック実行: バッチファイル・コマンドファイルをダブルクリックするだけで、Kumihan-Formatterを使ったテキスト変換が簡単に行えます。
;;;

;;;見出し2
対象ファイル一覧
;;;

;;;見出し3
Windows用バッチファイル
;;;

| ファイル名 | 場所 | 機能 |
|-----------|------|------|
| `初回セットアップ.bat` | `scripts/setup/` | 開発環境の自動セットアップ |

;;;見出し3
macOS用コマンドファイル
;;;

| ファイル名 | 場所 | 機能 |
|-----------|------|------|
| `初回セットアップ.command` | `scripts/setup/` | 開発環境の自動セットアップ |

;;;見出し2
基本的な使用方法
;;;

;;;見出し3
1. 初回セットアップ（必須）
;;;

**開発者向け**:
- **Windows**: `scripts/setup/Windows用初回セットアップ.bat` をダブルクリック
- **macOS**: `scripts/setup/macOS用初回セットアップ.command` をダブルクリック

**一般ユーザー**:
- GUIアプリを[リリースページ](https://github.com/mo9mo9-uwu-mo9mo9/Kumihan-Formatter/releases)からダウンロード

初回実行時の流れ：
1. Python環境のチェック
2. 仮想環境の自動作成
3. 依存関係の自動インストール
4. セットアップ完了確認

;;;枠線
【重要】初回セットアップは必ず最初に実行してください。
このステップを飛ばすと、他のツールが正常に動作しません。
;;;

;;;見出し3
2. テキストファイル変換
;;;

**GUIアプリを使用** (推奨):
1. アプリを起動
2. .txtファイルをドラッグ&ドロップ

**コマンドライン**:
```bash
python -m kumihan_formatter convert input.txt
```

;;;見出し4
方法A: ドラッグ&ドロップ
;;;

1. 変換ツールを起動
2. 表示されるウィンドウに `.txt` ファイルをドラッグ&ドロップ
3. 自動で変換が開始
4. 完了後、出力フォルダが自動で開く

;;;見出し4
方法B: 対話形式入力
;;;

1. 変換ツールを起動
2. ファイルパスの入力を求められる
3. 変換したいファイルのフルパスを入力
4. 自動で変換が開始

;;;ハイライト color=#e6f3ff
推奨: ドラッグ&ドロップ方式の方が簡単で確実です
;;;

;;;見出し3
3. 機能ショーケース確認
;;;

**コマンドライン**:
```bash
python -m kumihan_formatter sample
```

機能：
- Kumihan-Formatterの全機能を体験
- サンプルHTML生成
- ソーストグル機能のデモ

;;;見出し2
詳細な動作フロー
;;;

;;;見出し3
変換ツールの内部処理
;;;

1. **環境検証**
   - Python 3.9以上の確認
   - 仮想環境の存在確認
   - 依存関係の確認

2. **自動セットアップ（必要時）**
   - 仮想環境の自動作成
   - パッケージの自動インストール
   - 進捗表示付き

3. **実行コンテキスト検出**
   - デスクトップ実行: `%USERPROFILE%\Desktop\Kumihan_Output`
   - プロジェクト内実行: `../dist`

4. **ファイル変換**
   - 入力ファイルの検証
   - HTMLへの変換実行
   - 画像ファイルの自動コピー

5. **ソーストグル機能確認**
   - ユーザーに機能説明表示
   - Y/nで選択肢提示
   - 選択に応じたテンプレート適用

6. **結果表示**
   - 変換完了通知
   - 出力フォルダ開く確認
   - 自動ブラウザプレビュー

;;;見出し2
出力先について
;;;

;;;見出し3
自動判定される出力先
;;;

| 実行場所 | 出力先 | 理由 |
|---------|--------|------|
| デスクトップ | `%USERPROFILE%\Desktop\Kumihan_Output` | ユーザーが見つけやすい |
| プロジェクト内 | `../dist` | 開発作業に適している |

;;;見出し3
出力フォルダの構成
;;;

```
Kumihan_Output/ (または dist/)
├── sample.html          ← 変換されたHTMLファイル
├── images/              ← 画像ファイル（存在する場合）
│   ├── image1.png
│   └── image2.jpg
```

;;;見出し2
ソーストグル機能の詳細
;;;

;;;見出し3
機能概要
;;;

変換時に「記法と結果を並べて表示する機能があります」という説明が表示され、Y/nで選択できます。

;;;見出し4
選択時の動作
;;;

- **Y (Yes)**: `base-with-source-toggle.html.j2` テンプレート使用
- **n (No)**: `base.html.j2` テンプレート使用（標準）

;;;見出し4
ソーストグル機能の効果
;;;

- 記法テキストと変換結果を切り替え表示
- 記法学習や動作確認に最適
- ボタンクリックで即座に切り替え可能
- 改行処理などの細かい動作も確認可能

;;;見出し2
トラブルシューティング
;;;

;;;見出し3
よくあるエラーと解決方法
;;;

;;;見出し4
「Python が見つかりません」
;;;

**原因**: Python 3.9以上がインストールされていない

**解決方法**:
1. [Python公式サイト](https://www.python.org/downloads/)からPython 3.9以上をダウンロード
2. インストール時に「Add to PATH」をチェック
3. インストール後、バッチファイルを再実行

;;;見出し4
「仮想環境の作成に失敗しました」
;;;

**原因**: 権限不足またはディスク容量不足

**解決方法**:
- **Windows**: 管理者として実行
- **macOS**: `chmod +x` でファイルに実行権限を付与
- ディスク容量を確認（最低500MB必要）

;;;見出し4
「ファイルが見つかりません」
;;;

**原因**: ファイルパスに日本語や特殊文字が含まれている

**解決方法**:
- ファイル名とフォルダ名を半角英数字に変更
- スペースを含むパスは避ける
- または、プロジェクトフォルダにファイルをコピー

;;;見出し4
「変換中にエラーが発生しました」
;;;

**原因**: テキストファイルの記法にエラーがある

**解決方法**:
1. 生成されたHTMLファイルを確認
2. 赤い背景の`[ERROR:]`箇所を修正
3. 記法ガイド（SYNTAX_REFERENCE.md）を参照

;;;見出し3
パフォーマンス最適化
;;;

;;;見出し4
大きなファイルの処理
;;;

- ファイルサイズ1MB以上: 処理に数分かかる場合があります
- 推奨: 章ごとに分割して処理
- メモリ不足時: 他のアプリケーションを終了

;;;見出し4
高速化のコツ
;;;

- 不要な画像ファイルを削除
- 複雑な複合キーワードを減らす
- SSDでの実行を推奨

;;;見出し2
カスタマイズ
;;;

;;;見出し3
出力先の変更
;;;

バッチファイル内の `OUTPUT_DIR` を編集：

```batch
# Windows (変換ツール.bat)
set "OUTPUT_DIR=C:\MyOutput"

# macOS (変換ツール.command)
OUTPUT_DIR="$HOME/MyOutput"
```

;;;見出し3
デフォルト設定の変更
;;;

- ソーストグル機能を常に有効: `--with-source-toggle` をコマンドに追加
- プレビューを無効: `--no-preview` をコマンドに追加

;;;見出し2
D&D（ドラッグ&ドロップ）機能詳細
;;;

;;;見出し3
対応ファイル
;;;

- **拡張子**: `.txt` のみ
- **エンコーディング**: UTF-8推奨
- **ファイルサイズ**: 制限なし（ただし大きなファイルは処理時間がかかります）

;;;見出し3
ドラッグ&ドロップの手順
;;;

1. バッチファイルをダブルクリックで起動
2. コマンドプロンプト/ターミナル画面が表示
3. エクスプローラー/Finderから`.txt`ファイルを画面にドラッグ
4. ファイルをドロップ（マウスボタンを離す）
5. 自動で変換開始

;;;ハイライト color=#ffe6e6
注意: ドラッグ&ドロップは画面全体ではなく、文字が表示されている部分に行ってください
;;;

;;;見出し2
関連ドキュメント
;;;

- **[USER_MANUAL.txt](USER_MANUAL.txt)** - 基本的な使用方法
- **[CLI_REFERENCE.md](CLI_REFERENCE.md)** - コマンドライン詳細
- **[SYNTAX_REFERENCE.md](../SYNTAX_REFERENCE.md)** - Kumihan記法リファレンス
- **[TROUBLESHOOTING.md](TROUBLESHOOTING.md)** - 問題解決ガイド

;;;見出し2
サポート
;;;

問題が発生した場合は、GitHubのIssueで報告してください：

**必要な情報**:
1. OS (Windows 10/11 または macOS バージョン)
2. Python バージョン (`python --version`)
3. エラーメッセージの全文
4. 実行したファイル名と手順

---

;;;太字+ハイライト color=#e6ffe6
🎉 バッチファイル・コマンドファイルを使って、簡単にKumihan記法をHTMLに変換しましょう！
;;;
