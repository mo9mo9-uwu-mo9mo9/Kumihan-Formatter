# Kumihan記法 完全リファレンス

> 新規開発者・ユーザー向けKumihan記法の完全ガイド

## 📖 概要

Kumihan記法は、美しいHTMLドキュメントを簡単に作成するための、日本語に最適化されたマークアップ記法です。

### 基本理念

- **直感的**: 見た目で内容が予想できる
- **簡潔**: 最小限の記号で最大の表現力
- **一貫性**: 統一されたルールで覚えやすい
- **日本語特化**: 日本語文書作成に最適化

## 🏗️ 基本構造

### 統一ブロック記法

全てのKumihan記法は以下の統一構造を使用します：

```
# キーワード #
内容
##
```

**構成要素:**
- `#`: 開始マーカー
- `キーワード`: 装飾や機能を指定
- `#`: 中間マーカー
- `内容`: 実際のテキスト（複数行可）
- `##`: 終了マーカー（必須）

### 簡単な例

```
# 太字 #
これは重要な情報です
##
```

↓ HTML出力

```html
<p><strong>これは重要な情報です</strong></p>
```

## 📝 基本記法

### 見出し

```
# 見出し1 #
大見出し
##

# 見出し2 #
中見出し
##

# 見出し3 #
小見出し
##
```

**レベル:** 1〜6まで対応

### テキスト装飾

#### 太字

```
# 太字 #
重要な情報
##
```

#### イタリック

```
# イタリック #
強調したいテキスト
##
```

#### 下線

```
# 下線 #
下線付きテキスト
##
```

#### 取り消し線

```
# 取り消し線 #
削除されたテキスト
##
```

### 色とハイライト

#### ハイライト（基本）

```
# ハイライト #
注目すべき内容
##
```

#### 色指定ハイライト

```
# ハイライト color=yellow #
黄色でハイライト
##

# ハイライト color=red #
赤色でハイライト
##

# ハイライト color=#ff0000 #
カスタム色（16進数）
##
```

**対応色:**
- `red` / `赤`
- `blue` / `青`
- `green` / `緑`
- `yellow` / `黄`
- `orange` / `オレンジ`
- カスタム色: `#ff0000` 形式

### ブロック要素

#### 枠線

```
# 枠線 #
囲み内容です。
複数行も対応しています。
##
```

#### 引用

```
# 引用 #
誰かの言葉を引用する時に使用
##
```

#### 情報ボックス

```
# 情報 #
ℹ️ 補足情報
##

# 警告 #
⚠️ 注意が必要な内容
##

# エラー #
❌ エラー情報
##

# 成功 #
✅ 成功メッセージ
##
```

## 📋 リスト記法

### 順序なしリスト

```
# リスト #
- 項目1
- 項目2
- 項目3
##
```

### 順序付きリスト

```
# 順序リスト #
1. 手順1
2. 手順2
3. 手順3
##
```

### ネストリスト

```
# リスト #
- 大項目1
  - 小項目1
  - 小項目2
- 大項目2
  - 小項目3
##
```

## 🎨 複合記法

複数の装飾を組み合わせることができます。

### 基本的な複合

```
# 太字+下線 #
太字かつ下線のテキスト
##

# イタリック+ハイライト color=yellow #
イタリック＋黄色ハイライト
##
```

### 複合例

```
# 太字+枠線 #
重要な囲み情報
##

# ハイライト color=red+太字 #
赤色で太字の警告
##
```

## 🔗 特殊記法

### リンク

```
# リンク url=https://example.com #
リンクテキスト
##

# リンク url=https://example.com target=_blank #
新しいタブで開くリンク
##
```

### 画像

```
# 画像 src=image.jpg #
画像の説明文
##

# 画像 src=image.jpg alt=代替テキスト width=300 #
##
```

### テーブル

```
# テーブル #
| 列1 | 列2 | 列3 |
|-----|-----|-----|
| A   | B   | C   |
| 1   | 2   | 3   |
##
```

### コードブロック

```
# コード #
```python
def hello():
    print("Hello, World!")
```
##

# コード言語=javascript #
```javascript
console.log("Hello, World!");
```
##
```

## 🎭 TRPG・CoC特化記法

### ネタバレ隠し

```
# ネタバレ #
重要な情報だが、プレイヤーには隠したい内容
##

# ネタバレ タイトル=真実 #
クライマックスで明かされる真実
##
```

### NPC情報

```
# NPC名=田中一郎 #
- **職業**: 私立探偵
- **年齢**: 35歳
- **特徴**: 眼鏡をかけている
##
```

### 判定・技能

```
# 判定 #
**目星** (難易度: 普通)
成功すると手がかりを発見
##

# 技能 名前=図書館 難易度=困難 #
古い文献から情報を発見できる
##
```

### ハンドアウト

```
# ハンドアウト PC=1 #
あなたは怪奇現象の調査を依頼された私立探偵です。
##
```

## 🔧 高度な記法

### カスタム属性

```
# カスタム class=special-box id=unique-content #
カスタムCSSクラスやIDを指定
##
```

### 条件表示

```
# 条件 show-for=GM #
GMにのみ表示される情報
##

# 条件 show-for=Player #
プレイヤーにのみ表示される情報
##
```

### フォント指定

```
# フォント family=serif #
明朝体で表示
##

# フォント family=monospace size=14px #
等幅フォント、サイズ指定
##
```

## ✅ 記法の組み合わせ例

### 情報カード

```
# 枠線+ハイライト color=lightblue #
# 太字 #
重要なお知らせ
##

このイベントは明日開催されます。
参加希望の方は事前にご連絡ください。
##
```

### NPC詳細カード

```
# 枠線 #
# 太字+下線 #
田中一郎（私立探偵）
##

# リスト #
- **年齢**: 35歳
- **職業**: 私立探偵
- **特徴**: 眼鏡、茶髪
- **技能**: 目星80%, 図書館70%
##

# ネタバレ タイトル=真実 #
実は黒幕の一味である
##
##
```

### 判定結果表

```
# テーブル #
| 判定結果 | 成功 | 失敗 |
|----------|------|------|
| 目星 | 重要な手がかりを発見 | 何も見つからない |
| 聞き耳 | 怪しい音を聞く | 静寂のまま |
##
```

## 🚨 注意事項・制限

### 基本ルール

1. **終了マーカー必須**: 全記法で `##` が必要
2. **半角・全角混在禁止**: 一つのブロック内では統一
3. **改行重要**: キーワード行の次の行から内容開始
4. **属性記法**: `key=value` 形式で指定

### よくある間違い

❌ **間違い例**
```
# 太字 #重要情報##  <!-- 改行なし -->
```

✅ **正しい例**
```
# 太字 #
重要情報
##
```

❌ **間違い例**
```
#太字＃  <!-- 半角・全角混在 -->
内容
##
```

✅ **正しい例**
```
# 太字 #
内容
##
```

### エラーハンドリング

不正な記法はエラーメッセージと共に表示されます：

```
❌ 構文エラー: 行15: 未完了のブロック記法 '#太字 内容'
💡 修正提案: '##'を追加してブロックを完了してください
```

## 🎯 パフォーマンス考慮

### 大容量文書

- 1000行以上: 自動で並列処理が有効化
- 10000行以上: ストリーミング処理を推奨
- メモリ効率を重視した設計

### 最適化のヒント

```bash
# 大容量ファイルの処理
kumihan-formatter convert large-document.txt --progress-level minimal

# 並列処理の活用
kumihan-formatter convert document.txt --progress-style bar
```

## 📚 実践例

### シンプルな文書

```
# 見出し1 #
ドキュメントタイトル
##

# 太字 #
重要なポイント
##

通常のテキスト段落。

# リスト #
- 項目1
- 項目2
- 項目3
##
```

### CoC6thシナリオ

```
# 見出し1 #
「消えた図書館」
##

# 見出し2 #
導入
##

# 太字 #
プレイヤーへの導入
##

あなたたちは古い図書館で奇妙な現象に遭遇します。

# ネタバレ #
実はこの図書館には呪いがかけられている
##

# 判定 #
**目星判定**（難易度：普通）
成功すると不審な本を発見
##

# NPC名=司書・佐藤 #
- **年齢**: 60代
- **特徴**: 温厚そうな老人
- **秘密**: 呪いの儀式を知っている
##
```

### 技術ドキュメント

```
# 見出し1 #
API仕様書
##

# 見出し2 #
認証
##

# コード言語=bash #
```bash
curl -H "Authorization: Bearer token" https://api.example.com
```
##

# 情報 #
APIキーは環境変数で管理してください
##

# 警告 #
本番環境では必ずHTTPSを使用すること
##
```

## 🔗 関連リソース

### 開発者向け

- **[Parser API](../api/parser_api.md)** - パーサーAPIの詳細
- **[Renderer API](../api/renderer_api.md)** - レンダラーAPIの詳細
- **[CLI API](../api/cli_api.md)** - コマンドラインツールの使用法

### ユーザー向け

- **[ユーザーガイド](user-guide.md)** - 詳細な使用方法
- **[FAQ](faq.md)** - よくある質問と回答
- **[クイックスタート](getting-started.md)** - 30分で始めるガイド

### プロジェクト情報

- **[アーキテクチャ](../dev/architecture.md)** - システム設計思想
- **[コーディング規約](../dev/coding-standards.md)** - 開発ルール
- **[GitHub Repository](https://github.com/mo9mo9-uwu-mo9mo9/Kumihan-Formatter)** - ソースコード

---

**Kumihan記法をマスターして、美しい文書を作成しましょう！** 📝✨