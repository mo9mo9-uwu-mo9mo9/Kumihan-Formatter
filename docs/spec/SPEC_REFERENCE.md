# Kumihan記法 リファレンス

> **Kumihan記法の制限事項、非サポート機能、トラブルシューティング**

---

## ❌ 非サポート記法

以下の記法は**Kumihan記法として公式にサポートしていません**：

- **行頭 `#` 記法**: `# 見出し` は無視されます（Markdown形式は非対応）
- **インライン記法**: `**太字**` 等のMarkdown記法は非対応  
- **コメント記法**: `//` や `<!-- -->` 等のコメント機能は非対応

これらの記法を使用した場合、テキストとして扱われるか無視されます。

### Kumihan記法とMarkdown記法の使い分け

**重要**: 
- **変換対象ファイル**: Kumihan記法（`;;;見出し1;;;` 等）を使用
- **ドキュメントファイル**: 必要に応じてMarkdown記法も使用可能

この仕様書に記載された記法のみがKumihan-Formatterで正しく変換されます。

---

## ⚠️ よくある間違いと対処法

| 間違った記法 | 正しい記法 | 説明 |
|-------------|-----------|-------|
| `# 見出し` | `;;;見出し1\n見出し\n;;;` | Markdown記法は非サポート |
| `**太字**` | `;;;太字\n太字\n;;;` | インライン記法は非サポート |
| `;;;ハイライト color=#ff0000+太字;;;` | `;;;太字+ハイライト color=#ff0000;;;` | color属性は最後に配置 |
| `;;;目次;;;` 手動記述 | （目次マーカーは自動検出） | 見出しがあれば自動生成 |
| `;;;見出し1\n内容` | `;;;見出し1\n内容\n;;;` | 閉じマーカーを忘れずに |
| `;;;太字;;;` 空ブロック | 内容を記述する | 空ブロックはエラー |

---

## 🔧 記法検証ツール

記法の正しさを自動でチェックできます：

```bash
# 単一ファイルの検証
python -m kumihan_formatter.core.syntax.syntax_validator examples/sample.txt

# 複数ファイルの一括検証
python -m kumihan_formatter.core.syntax.syntax_validator examples/*.txt

# テストスイートによる検証
python -m pytest dev/tests/test_syntax_validation.py -v
```

---

## 📋 使用制限・注意事項

### ブロック制限
- 目次マーカー `;;;目次;;;` は手動使用禁止（自動生成専用）
- ブロック内でのブロック記法は非サポート（ネストエラー）
- 空ブロックはエラーとして扱われます

### キーワード制限
- 存在しないキーワードは文字列として出力
- 複合キーワードは最大3つまでを推奨
- 色指定は `color=#hex` 形式のみサポート

### ファイル制限
- 画像ファイルは `images/` フォルダ内のみ認識
- サポート画像形式: PNG, JPG, JPEG, GIF, SVG
- ファイル名に日本語・スペースは使用可能

---

## 🐛 トラブルシューティング

### 1. 記法が認識されない
**症状**: Kumihan記法を書いても普通のテキストとして出力される

**原因と対処**:
- マーカー `;;;` が全角になっている → 半角に修正
- 閉じマーカーが不足している → `;;;` を追加
- 存在しないキーワードを使用 → 正しいキーワードに修正

### 2. 複合キーワードが効かない
**症状**: `;;;太字+枠線;;;` が期待通りに動作しない

**原因と対処**:
- 連結記号が全角 `＋` の場合もある → 確認が必要
- キーワードの順序を変更してみる
- スペースの有無を調整

### 3. 目次が生成されない
**症状**: `;;;目次;;;` を書いても目次が表示されない

**原因と対処**:
- 見出しブロックが存在しない → 見出しを追加
- 手動で `;;;目次;;;` を記述している → 自動生成に任せる

### 4. 画像が表示されない
**症状**: 画像記法を使っても画像が表示されない

**原因と対処**:
- ファイルパスが間違っている → `images/filename` を確認
- ファイルが存在しない → ファイルの存在を確認
- alt属性が正しく設定されていない → 記法を確認

---

**関連ドキュメント:**
- コア仕様: [SPEC_CORE.md](SPEC_CORE.md)
- 構文詳細: [SPEC_SYNTAX.md](SPEC_SYNTAX.md)
- 実装指針: [SPEC_IMPLEMENTATION.md](SPEC_IMPLEMENTATION.md)