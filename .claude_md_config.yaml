# CLAUDE.md Management System Configuration
# Issue #686 対応設定ファイル

limits:
  # 段階制限システム（緩和版）
  warning:
    lines: 250
    bytes: 12288  # 12KB
  caution:
    lines: 300
    bytes: 15360  # 15KB
  critical:
    lines: 400
    bytes: 20480  # 20KB

  # 旧制限（参考値・推奨）
  recommended_lines: 150
  recommended_bytes: 8192  # 8KB

  # 構造制限
  max_section_lines: 20
  max_nesting_depth: 3

structure:
  # 必須セクション
  required_sections:
    - "AI運用7原則"
    - "基本設定"
    - "必須ルール"
    - "記法仕様"

  # 古いマーカー検出
  outdated_markers:
    - "TODO"
    - "FIXME"
    - "v1."
    - "alpha-"
    - "beta-"
    - "Phase 1"  # 完了したPhaseマーカー

  # 禁止パターン
  forbidden_patterns:
    - "日本語ブランチ名"  # 既に禁止されている項目
    - "手動レビュー無効"   # 変更された項目

optimization:
  enabled: true
  auto_fix: false  # 安全性重視でデフォルト無効
  backup_before_fix: true

  # 自動修正対象
  auto_fix_types:
    - "trailing_whitespace"
    - "excess_newlines"
    - "simple_duplicates"

  # 最適化提案
  suggestion_types:
    - "section_consolidation"
    - "content_deduplication"
    - "outdated_removal"
    - "size_reduction"

monitoring:
  # 履歴管理
  keep_history_days: 90
  max_history_entries: 100

  # アラート設定
  alert_on_critical: true
  alert_on_size_increase: true
  alert_threshold_percent: 10  # 10%以上のサイズ増加で警告

# Phase 3: プロセス統合設定
process_integration:
  issue_completion:
    auto_archive_completed: true
    move_to_history_section: true

  release_cycle:
    auto_cleanup_on_release: true
    version_archive: true

  documentation_split:
    max_main_size_kb: 8
    external_docs_dir: "docs/claude_instructions"

# 🚀 MCP効率化設定（Issue804 AI最適化統合）
mcp_efficiency:
  # AI最適化システム連携設定
  ai_integration:
    enabled: true
    phase_b4_system: true        # Phase B.4システム使用
    prediction_engine: true      # 予測エンジン有効
    adaptive_control: true       # 適応制御有効

  # serenaツール効率化
  serena_optimization:
    # 動的パラメータ調整
    dynamic_parameters:
      max_answer_chars:
        base: 200000             # ベース値
        ai_adjustment: true      # AI自動調整
        context_scaling: true    # コンテキスト規模連動
        min_value: 50000         # 最小値
        max_value: 500000        # 最大値

      context_lines_before:
        base: 3
        max_adjustment: 10       # 最大調整値

      context_lines_after:
        base: 3
        max_adjustment: 10

    # 最適化戦略
    optimization_strategies:
      token_reduction_mode: "aggressive"  # conservative, balanced, aggressive
      cache_predictions: true             # 予測結果キャッシュ
      batch_operations: true              # バッチ処理
      smart_filtering: true               # スマートフィルタリング

  # 効果測定・監視
  monitoring:
    enabled: true
    real_time_metrics: true      # リアルタイム測定
    performance_tracking: true   # 性能追跡
    efficiency_alerts: true      # 効率性アラート
    target_reduction: 68.8       # 目標削減率（%）

  # 自動最適化機能
  auto_optimization:
    enabled: true
    trigger_threshold: 60.0      # 最適化トリガー閾値（削減率%）
    adjustment_frequency: "adaptive"  # fixed, adaptive, continuous
    learning_enabled: true       # 学習機能有効
