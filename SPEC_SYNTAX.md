# Kumihan記法 構文詳細

> **Kumihan記法の詳細な構文説明と豊富な例文集**

---

## 🎆 寛容な記法サポート

初心者に優しい寛容な記法をサポートしています。以下のすべての書き方が同じ結果になります：

### スペースのバリエーション

```
;;;ハイライト color=#ff0000     # 標準（半角スペース）
;;;ハイライト　color=#ff0000    # 全角スペース
;;;ハイライトcolor=#ff0000      # スペースなし
;;;ハイライト  color=#ff0000    # 複数スペース
  ;;;ハイライト color=#ff0000   # 前後スペース
```

### 複合キーワードのバリエーション

```
;;;太字 + ハイライト color=#ff0000   # 標準
;;;太字　+　ハイライト　color=#ff0000  # 全角スペース
;;;太字+ハイライトcolor=#ff0000        # スペースなし
;;;太字   +   ハイライト   color=#ff0000 # 複数スペース
```

**自動正規化**: 全て自動的に標準形式に正規化され、同じ結果が得られます。

---

## 📝 構文例

### 基本ブロック例
```
;;;見出し2
見出しテキスト
;;;
```
↓
```html
<h2>見出しテキスト</h2>
```

### 複合ブロック例
```
;;;見出し2+太字
こんにちは
;;;
```
↓
```html
<h2><strong>こんにちは</strong></h2>
```

### 色付きハイライト例
```
;;;ハイライト color=#ffe6e6
注意事項
;;;
```
↓
```html
<div class="highlight" style="background-color:#ffe6e6">注意事項</div>
```

### 折りたたみブロック例
```
;;;折りたたみ
詳細情報はこちら
;;;
```
↓
```html
<details><summary>詳細を表示</summary>詳細情報はこちら</details>
```

### ネタバレブロック例
```
;;;ネタバレ
重要なネタバレ情報
;;;
```
↓
```html
<details><summary>ネタバレを表示</summary>重要なネタバレ情報</details>
```

### 複合折りたたみ例
```
;;;ネタバレ+太字
最終的な真実
;;;
```
↓
```html
<details><summary>ネタバレを表示</summary><strong>最終的な真実</strong></details>
```

### 番号付きリスト例
```
1. 最初の項目
2. 2番目の項目
3. 3番目の項目
```
↓
```html
<ol>
<li>最初の項目</li>
<li>2番目の項目</li>
<li>3番目の項目</li>
</ol>
```

### キーワード付きリスト例
```
- ;;;太字+枠線;;; 複合スタイル項目
```
↓
```html
<ul><li><div class="box"><strong>複合スタイル項目</strong></div></li></ul>
```

### 中黒リスト例
```
・一般住宅、マンション
・公園、学校
・小さな商店、診療所
```
↓
```html
<ul>
<li>一般住宅、マンション</li>
<li>公園、学校</li>
<li>小さな商店、診療所</li>
</ul>
```

### 中黒リストのキーワード付き例
```
・;;;太字;;; 企業のオフィスビル
・;;;太字+ハイライト color=#f0fff0;;; 住宅地・郊外
```
↓
```html
<ul>
<li><strong>企業のオフィスビル</strong></li>
<li><div class="highlight" style="background-color:#f0fff0"><strong>住宅地・郊外</strong></div></li>
</ul>
```

### 画像埋め込み例（簡易記法）
```
;;;sample.png;;;
```
↓
```html
<img src="images/sample.png" alt="sample.png" />
```

### 画像埋め込み例（詳細記法）
```
;;;画像 alt=サンプル画像
sample.png
;;;
```
↓
```html
<img src="images/sample.png" alt="サンプル画像" />
```

### 目次マーカー例
```
;;;目次;;;

;;;見出し1
第1章
;;;

;;;見出し2
第1節
;;;
```
↓
```html
<div class="toc">
  <h3>目次</h3>
  <ul>
    <li><a href="#heading-1">第1章</a></li>
    <li><a href="#heading-2">第1節</a></li>
  </ul>
</div>

<h1 id="heading-1">第1章</h1>
<h2 id="heading-2">第1節</h2>
```

---

## ⚠️ エラーハンドリング

### よくあるエラーと対処法

1. **キーワード名エラー**
   - 問題: 存在しないキーワード `;;;未対応キーワード;;;`
   - 対処: そのまま文字列として出力

2. **記法不完全エラー**
   - 問題: 終了マーカーなし `;;;太字\n内容`
   - 対処: 自動で終了マーカーを補完

3. **ネストエラー**
   - 問題: ブロック内でのブロック記法
   - 対処: 外側のブロックを優先

---

**関連ドキュメント:**
- コア仕様: [SPEC_CORE.md](SPEC_CORE.md)
- リファレンス: [SPEC_REFERENCE.md](SPEC_REFERENCE.md)
- 実装指針: [SPEC_IMPLEMENTATION.md](SPEC_IMPLEMENTATION.md)