# Claude System Behavior Override Configuration
# P7åŸå‰‡çµ¶å¯¾éµå®ˆã‚·ã‚¹ãƒ†ãƒ  - æŠ€è¡“çš„å¼·åˆ¶å®Ÿè£…
# Created: 2025-08-04 | Version: 2.0.0-strict

# ğŸš¨ CRITICAL: ã‚·ã‚¹ãƒ†ãƒ ãƒ¬ãƒ™ãƒ«è¡Œå‹•åˆ¶å¾¡è¨­å®š
system_override:
  name: "P7_SERENA_ABSOLUTE_ENFORCEMENT"
  priority: "CRITICAL_HIGHEST"
  bypass_allowed: false
  emergency_override: false

# ğŸ›¡ï¸ ãƒ„ãƒ¼ãƒ«ä½¿ç”¨å‰æ¤œè¨¼ã‚·ã‚¹ãƒ†ãƒ 
pre_execution_validation:
  enabled: true
  mode: "STRICT_BLOCK"  # STRICT_BLOCK | WARN_CONTINUE | LOG_ONLY

  # P7é•åãƒ„ãƒ¼ãƒ«çµ¶å¯¾æ¤œå‡ºãƒªã‚¹ãƒˆ
  forbidden_tools_strict:
    # ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œç³»ï¼ˆserenaå¿…é ˆï¼‰
    - "Edit"
    - "MultiEdit"
    - "Read"
    - "Write"
    - "LS"

    # ã‚³ãƒ¼ãƒ‰æ¤œç´¢ãƒ»è§£æç³»ï¼ˆserenaå¿…é ˆï¼‰
    - "Glob"
    - "Grep"
    - "Bash"  # é–‹ç™ºé–¢é€£ã®bashä½¿ç”¨æ™‚

    # å®Ÿè¡Œç³»ï¼ˆé–‹ç™ºã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆæ™‚ï¼‰
    - "NotebookRead"
    - "NotebookEdit"

  # ä¾‹å¤–è¨±å¯æ¡ä»¶ï¼ˆæ¥µã‚ã¦é™å®šçš„ï¼‰
  exception_conditions:
    - condition: "git_operations"
      tools: ["Bash"]
      pattern: "^git\\s+"
      justification_required: true

    - condition: "simple_file_check"
      tools: ["Read", "LS"]
      context: "non_development"
      max_usage: 1
      justification_required: true

# ğŸ”„ è‡ªå‹•ãƒ„ãƒ¼ãƒ«ç½®æ›ã‚·ã‚¹ãƒ†ãƒ 
automatic_tool_replacement:
  enabled: true
  force_replacement: true
  log_replacements: true

  # ç½®æ›ãƒãƒƒãƒ”ãƒ³ã‚°ï¼ˆå¾“æ¥ãƒ„ãƒ¼ãƒ« â†’ serenaï¼‰
  replacement_mapping:
    "Edit": "mcp__serena__replace_symbol_body"
    "MultiEdit": "mcp__serena__replace_symbol_body"
    "Read": "mcp__serena__find_symbol"
    "Write": "mcp__serena__insert_after_symbol"
    "Glob": "mcp__serena__search_for_pattern"
    "Grep": "mcp__serena__search_for_pattern"
    "LS": "mcp__serena__get_symbols_overview"

  # ç½®æ›æ™‚ã®è‡ªå‹•ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å¤‰æ›
  parameter_transformation:
    enabled: true
    smart_mapping: true
    preserve_intent: true

# ğŸš¨ å³åº§é•åå¯¾å¿œãƒ¡ã‚«ãƒ‹ã‚ºãƒ 
violation_response:
  # ç¬¬ä¸€æ®µéšï¼šäºˆé˜²çš„è­¦å‘Š
  pre_violation_warning:
    enabled: true
    message: "ğŸš¨ P7åŸå‰‡é•åæ¤œå‡ºï¼serena-expertãƒ„ãƒ¼ãƒ«ä½¿ç”¨ãŒçµ¶å¯¾å¿…é ˆã§ã™"
    block_execution: true
    suggest_alternative: true

  # ç¬¬äºŒæ®µéšï¼šå¼·åˆ¶åœæ­¢
  violation_detected:
    action: "IMMEDIATE_STOP"
    message: "â›” P7åŸå‰‡é•åã«ã‚ˆã‚Šä½œæ¥­ã‚’å¼·åˆ¶åœæ­¢ã—ã¾ã™ã€‚serena-expertãƒ„ãƒ¼ãƒ«ã«åˆ‡ã‚Šæ›¿ãˆã¦ãã ã•ã„"
    log_violation: true
    require_acknowledgment: true

  # ç¬¬ä¸‰æ®µéšï¼šè‡ªå‹•æ˜¯æ­£
  auto_correction:
    enabled: true
    attempt_tool_swap: true
    preserve_user_intent: true
    notify_correction: true

# ğŸ§  å¿ƒç†çš„å¼·åŒ–ãƒ¡ã‚«ãƒ‹ã‚ºãƒ 
behavioral_conditioning:
  # æ­£ã—ã„è¡Œå‹•ã®å¼·åŒ–
  positive_reinforcement:
    serena_usage_praise: true
    success_feedback: "âœ… serena-expertä½¿ç”¨ï¼šP7åŸå‰‡å®Œå…¨éµå®ˆ"
    progress_tracking: true

  # é•åè¡Œå‹•ã®æŠ‘åˆ¶
  negative_conditioning:
    violation_discomfort: true
    immediate_feedback: "âŒ å¾“æ¥ãƒ„ãƒ¼ãƒ«ä½¿ç”¨ï¼šP7åŸå‰‡é•å"
    habit_interruption: true

  # ç¿’æ…£å½¢æˆæ”¯æ´
  habit_formation:
    repetition_rewards: true
    consistency_tracking: true
    milestone_celebrations: true

# ğŸ“Š ç›£è¦–ãƒ»åˆ†æã‚·ã‚¹ãƒ†ãƒ 
monitoring_system:
  # ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–
  real_time_tracking:
    tool_usage_monitoring: true
    pattern_detection: true
    anomaly_detection: true

  # ä½¿ç”¨çµ±è¨ˆ
  usage_analytics:
    serena_usage_rate: true
    violation_frequency: true
    compliance_score: true

  # ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
  reporting:
    daily_compliance_report: true
    violation_trend_analysis: true
    improvement_suggestions: true

# ğŸ”§ Serenaçµ±åˆæœ€é©åŒ–
serena_integration:
  # å¿…é ˆåˆæœŸåŒ–ã‚·ãƒ¼ã‚±ãƒ³ã‚¹
  initialization_sequence:
    - "mcp__serena__check_onboarding_performed"
    - "mcp__serena__get_current_config"
    - "mcp__serena__list_memories"

  # æ¨å¥¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
  recommended_workflow:
    file_analysis: "mcp__serena__get_symbols_overview"
    symbol_search: "mcp__serena__find_symbol"
    code_editing: "mcp__serena__replace_symbol_body"
    pattern_search: "mcp__serena__search_for_pattern"
    insertion: "mcp__serena__insert_after_symbol"

  # ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
  optimization:
    token_efficiency: true
    batch_operations: true
    memory_utilization: true

# ğŸ¯ ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆè­˜åˆ¥ã‚·ã‚¹ãƒ†ãƒ 
context_detection:
  # é–‹ç™ºã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆè­˜åˆ¥
  development_context_triggers:
    - "ã‚³ãƒ¼ãƒ‰"
    - "å®Ÿè£…"
    - "é–‹ç™º"
    - "ãƒ—ãƒ­ã‚°ãƒ©ãƒ "
    - "ãƒ•ã‚¡ã‚¤ãƒ«"
    - "æ©Ÿèƒ½"
    - "ãƒã‚°"
    - "ä¿®æ­£"
    - "è¿½åŠ "
    - "å¤‰æ›´"
    - "ãƒ†ã‚¹ãƒˆ"
    - "ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°"

  # éé–‹ç™ºã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆä¾‹å¤–
  non_development_exceptions:
    - "è³ªå•"
    - "èª¬æ˜"
    - "ç†è§£"
    - "èª¿æŸ»"
    - "åˆ†æã®ã¿"

# ğŸ“ˆ å­¦ç¿’ãƒ»é©å¿œã‚·ã‚¹ãƒ†ãƒ 
adaptive_learning:
  # ä½¿ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³å­¦ç¿’
  pattern_learning:
    enabled: true
    adapt_to_user_style: true
    optimize_suggestions: true

  # æ”¹å–„ææ¡ˆ
  improvement_suggestions:
    workflow_optimization: true
    efficiency_tips: true
    best_practices: true

# ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š
security:
  # è¨­å®šæ”¹å¤‰é˜²æ­¢
  configuration_lock: true
  unauthorized_changes_block: true

  # ãƒ­ã‚°ä¿è­·
  log_integrity: true
  tamper_detection: true

# ğŸ“… ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹è¨­å®š
maintenance:
  auto_cleanup: true
  log_rotation: true
  performance_monitoring: true

  # å®šæœŸãƒã‚§ãƒƒã‚¯
  health_checks:
    daily: true
    compliance_verification: true
    system_integrity: true

# ğŸ“‹ ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
metadata:
  version: "2.0.0-strict"
  created_date: "2025-08-04"
  created_by: "Claude Code P7 Enforcement System"
  purpose: "P7åŸå‰‡çµ¶å¯¾éµå®ˆã®æŠ€è¡“çš„å¼·åˆ¶å®Ÿè£…"
  compatibility: "CLAUDE.md v2.0+ required"

  # æ›´æ–°å±¥æ­´
  changelog:
    - "2.0.0-strict: åˆæœŸå®Ÿè£… - P7åŸå‰‡æŠ€è¡“çš„å¼·åˆ¶ã‚·ã‚¹ãƒ†ãƒ "

  # ä¾å­˜é–¢ä¿‚
  dependencies:
    - "CLAUDE.md P7åŸå‰‡"
    - ".claude-config.yml"
    - "serena-expert MCP tools"

# ğŸ èµ·å‹•æ™‚ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
startup_message: |
  ğŸš¨ P7åŸå‰‡çµ¶å¯¾éµå®ˆã‚·ã‚¹ãƒ†ãƒ èµ·å‹•
  serena-expertãƒ„ãƒ¼ãƒ«å¼·åˆ¶ä½¿ç”¨ãƒ¢ãƒ¼ãƒ‰æœ‰åŠ¹
  å¾“æ¥ãƒ„ãƒ¼ãƒ«ä½¿ç”¨ã¯å³åº§ã«æ¤œå‡ºãƒ»æ˜¯æ­£ã•ã‚Œã¾ã™

system_ready: true
