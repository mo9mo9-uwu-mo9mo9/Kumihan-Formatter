# Claude Code設定ファイル - Kumihan-Formatter専用
# Serena-Expert強制使用システム設定

project_name: "Kumihan-Formatter"
project_type: "python_library"

# 🚨 SERENA-EXPERT絶対必須設定
mandatory_tools:
  # 開発関連タスクでserena-expert絶対必須
  development_tasks: "serena-expert"
  code_implementation: "serena-expert"
  component_creation: "serena-expert"
  file_editing: "serena-expert"
  symbol_manipulation: "serena-expert"
  code_analysis: "serena-expert"
  refactoring: "serena-expert"
  testing: "serena-expert"

# 強制レベル設定
enforcement:
  level: "strict"          # strict: 違反時即座停止
  monitoring: true         # 使用履歴監視有効
  auto_correction: true    # 自動是正機能有効
  violation_action: "stop" # 違反時の動作: stop(停止), warn(警告), redirect(リダイレクト)

# 禁止ツール（従来ツール使用禁止）
forbidden_tools:
  - "Edit"
  - "MultiEdit"
  - "Read"
  - "Write"
  - "Bash"
  - "Glob"
  - "Grep"

# 例外許可（緊急時のみ）
exceptions:
  emergency_only: true
  requires_explicit_permission: true
  log_all_exceptions: true

# Serena設定
serena:
  priority_tools:
    - "mcp__serena__find_symbol"
    - "mcp__serena__replace_symbol_body"
    - "mcp__serena__insert_after_symbol"
    - "mcp__serena__search_for_pattern"
    - "mcp__serena__get_symbols_overview"

  required_checks:
    - onboarding_performed
    - memory_usage
    - symbol_analysis

# 🚨 AI最適化システム統合設定（Issue804対応）
ai_optimization:
  # Phase B.4 AI最適化システム統合
  enabled: true
  integration_level: "full"
  auto_activation: true

  # AI効率化設定
  efficiency_targets:
    token_reduction_target: 68.8  # Phase B4達成目標（%）
    prediction_accuracy: 85.0     # 予測精度閾値（%）
    response_time_max: 2.0        # 最大応答時間（秒）
    memory_optimization: true     # メモリ最適化有効

  # serena統合最適化
  serena_integration:
    dynamic_parameters: true      # 動的パラメータ調整
    context_optimization: true    # コンテキスト最適化
    batch_processing: true        # バッチ処理最適化
    cache_predictions: true       # 予測結果キャッシュ

  # MCP通信効率化
  mcp_optimization:
    max_answer_chars_dynamic: true    # 動的文字数制限調整
    context_aware_limits: true        # コンテキスト認識制限
    compression_enabled: true         # 通信圧縮有効
    smart_batching: true             # スマートバッチング

  # AI駆動型設定調整
  adaptive_settings:
    auto_parameter_tuning: true       # 自動パラメータ調整
    performance_monitoring: true      # 性能継続監視
    optimization_triggers:           # 最適化トリガー設定
      - "token_usage_threshold"      # Token使用量閾値
      - "response_time_degradation"  # 応答時間劣化
      - "prediction_accuracy_drop"   # 予測精度低下
      - "memory_pressure"            # メモリ圧迫

  # フォールバック設定
  fallback:
    auto_fallback: true              # 自動フォールバック
    fallback_threshold: 60.0         # フォールバック閾値（削減率%）
    emergency_mode: true             # 緊急モード有効
    recovery_attempts: 3             # 復旧試行回数

# 監視・ログ設定
monitoring:
  enabled: true
  log_file: ".claude-usage.log"
  track_violations: true
  generate_reports: true

# 品質保証
quality_assurance:
  code_style: "black"
  type_checking: "mypy_strict"
  import_sorting: "isort"
  encoding: "utf-8"

# プロジェクト固有設定
project_specific:
  notation_system: "kumihan_alpha_dev"
  block_notation_only: true
  japanese_language: true
  strict_branch_naming: true

# MCP効率化統合設定ファイル参照
include_configs:
  - ".claude-mcp-efficiency.yml"    # MCP効率化専用設定
  - ".claude-ai-integration.yml"    # AI統合設定

# 更新履歴
version: "2.0.0"
last_updated: "2025-08-05"
created_by: "Claude Code serena-expert System + AI Optimization"
changelog:
  - "v2.0.0: Issue804 AI最適化システム統合、MCP効率化設定追加"
  - "v1.0.0: serena-expert強制使用システム基本実装"
