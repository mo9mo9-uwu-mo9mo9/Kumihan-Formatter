# P7åŸå‰‡çµ¶å¯¾éµå®ˆã‚·ã‚¹ãƒ†ãƒ  - æŠ€è¡“çš„å¼·åˆ¶å®Ÿè£…

> **ğŸš¨ CRITICAL SYSTEM - P7åŸå‰‡é•åã®å®Œå…¨é˜²æ­¢**
> 
> Created: 2025-08-04  
> Status: Production Ready  
> Purpose: CLAUDE.md P7åŸå‰‡ã®å¿ƒç†çš„ãƒ»æŠ€è¡“çš„å¼·åˆ¶å®Ÿè£…

## ğŸ¯ ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦

ã“ã®ã‚·ã‚¹ãƒ†ãƒ ã¯ã€CLAUDE.md ã® **P7åŸå‰‡ï¼ˆserena-expertçµ¶å¯¾å¿…é ˆï¼‰** ã®é•åã‚’å®Ÿè³ªçš„ã«ä¸å¯èƒ½ã«ã™ã‚‹å¤šå±¤é˜²å¾¡ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚

### ğŸ›¡ï¸ é˜²å¾¡å±¤æ§‹é€ 

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   P7åŸå‰‡çµ¶å¯¾éµå®ˆã‚·ã‚¹ãƒ†ãƒ                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Layer 1: å¿ƒç†çš„æ¡ä»¶ä»˜ã‘ (.claude-behavioral-control.json) â”‚
â”‚ Layer 2: ã‚·ã‚¹ãƒ†ãƒ è¨­å®šåˆ¶å¾¡ (.claude-system-override.yml)   â”‚
â”‚ Layer 3: å®Ÿè¡Œæ™‚æ¤œè¨¼ (tool_validation_wrapper.py)         â”‚
â”‚ Layer 4: äº‹å¾Œåˆ†æãƒ»å­¦ç¿’ (p7_enforcement_system.py)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  çµæœ: P7é•å = ä¸å¯èƒ½                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

### 1. `.claude-system-override.yml`
**ã‚·ã‚¹ãƒ†ãƒ ãƒ¬ãƒ™ãƒ«è¡Œå‹•åˆ¶å¾¡**
- ãƒ„ãƒ¼ãƒ«ä½¿ç”¨å‰æ¤œè¨¼ã‚·ã‚¹ãƒ†ãƒ 
- è‡ªå‹•ãƒ„ãƒ¼ãƒ«ç½®æ›æ©Ÿèƒ½
- é•åæ™‚å³åº§åœæ­¢ãƒ¡ã‚«ãƒ‹ã‚ºãƒ 
- å¿ƒç†çš„å¼·åŒ–ã‚·ã‚¹ãƒ†ãƒ 

### 2. `.claude-behavioral-control.json`
**å¿ƒç†çš„æ¡ä»¶ä»˜ã‘ã‚·ã‚¹ãƒ†ãƒ **
- é•åæ™‚ã®ä¸å¿«æ„Ÿç”Ÿæˆ
- serenaä½¿ç”¨æ™‚ã®å ±é…¬ã‚·ã‚¹ãƒ†ãƒ 
- ç¿’æ…£å½¢æˆæ”¯æ´ãƒ¡ã‚«ãƒ‹ã‚ºãƒ 
- è‡ªå‹•ææ¡ˆæ©Ÿèƒ½

### 3. `scripts/p7_enforcement_system.py`
**åŒ…æ‹¬çš„å¼·åˆ¶å®Ÿè£…ã‚·ã‚¹ãƒ†ãƒ **
- ãƒ„ãƒ¼ãƒ«ä½¿ç”¨æ¤œè¨¼ã‚¨ãƒ³ã‚¸ãƒ³
- ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹åˆ†æ
- è‡ªå‹•æ˜¯æ­£æ©Ÿèƒ½
- è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ

### 4. `scripts/tool_validation_wrapper.py`
**ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ¤œè¨¼ãƒ©ãƒƒãƒ‘ãƒ¼**
- ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œã‚¤ãƒ³ã‚¿ãƒ¼ã‚»ãƒ—ãƒˆ
- äº‹å‰æ¤œè¨¼ã‚²ãƒ¼ãƒˆ
- è‡ªå‹•ä»£æ›¿ææ¡ˆ
- ä½¿ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ†æ

## ğŸš€ ã‚·ã‚¹ãƒ†ãƒ å‹•ä½œåŸç†

### Phase 1: äºˆé˜²çš„åˆ¶å¾¡
```
ãƒ¦ãƒ¼ã‚¶ãƒ¼æ€è€ƒã€ŒEditãƒ„ãƒ¼ãƒ«ã‚’ä½¿ãŠã†ã€
    â†“
å¿ƒç†çš„æ¡ä»¶ä»˜ã‘: "serena-expertã‚’ä½¿ã„ãŸã„è¡å‹•"
    â†“
ã‚·ã‚¹ãƒ†ãƒ ææ¡ˆ: "mcp__serena__replace_symbol_bodyæ¨å¥¨"
    â†“
è‡ªå‹•é¸æŠ: serena-expertãƒ„ãƒ¼ãƒ«
```

### Phase 2: å®Ÿè¡Œæ™‚æ¤œè¨¼
```
Claudeã€ŒEditãƒ„ãƒ¼ãƒ«ã‚’å®Ÿè¡Œã—ã‚ˆã†ã¨ã™ã‚‹ã€
    â†“
validation_wrapper: "ğŸš¨ P7é•åæ¤œå‡ºï¼"
    â†“
è‡ªå‹•ç½®æ›: Edit â†’ mcp__serena__replace_symbol_body  
    â†“
æ­£å¸¸å®Ÿè¡Œ: serena-expertãƒ„ãƒ¼ãƒ«ä½¿ç”¨
```

### Phase 3: äº‹å¾Œå¼·åŒ–
```
serenaä½¿ç”¨å®Œäº†
    â†“
positive_reinforcement: "âœ… ç´ æ™´ã‚‰ã—ã„ï¼P7åŸå‰‡éµå®ˆ"
    â†“
habit_strengthening: ä½¿ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³è¨˜éŒ²ãƒ»å¼·åŒ–
    â†“
ç¶™ç¶šçš„æ”¹å–„: æ¬¡å›æ›´ã«è‡ªå‹•çš„ã«serenaé¸æŠ
```

## ğŸ”§ å®Ÿè£…è©³ç´°

### ç¦æ­¢ãƒ„ãƒ¼ãƒ«ä¸€è¦§
```yaml
forbidden_tools_strict:
  - "Edit"          # â†’ mcp__serena__replace_symbol_body
  - "MultiEdit"     # â†’ mcp__serena__replace_symbol_body  
  - "Read"          # â†’ mcp__serena__find_symbol
  - "Write"         # â†’ mcp__serena__insert_after_symbol
  - "Glob"          # â†’ mcp__serena__search_for_pattern
  - "Grep"          # â†’ mcp__serena__search_for_pattern
  - "LS"            # â†’ mcp__serena__get_symbols_overview
  - "Bash"          # â†’ é–‹ç™ºã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆæ™‚ã®ã¿åˆ¶é™
```

### serena-expertãƒ„ãƒ¼ãƒ«ç¾¤
```yaml
serena_tools:
  - "mcp__serena__find_symbol"
  - "mcp__serena__replace_symbol_body"
  - "mcp__serena__insert_after_symbol"
  - "mcp__serena__search_for_pattern"
  - "mcp__serena__get_symbols_overview"
  - "mcp__serena__list_dir"
  - "mcp__serena__find_referencing_symbols"
  - "mcp__serena__insert_before_symbol"
  - "mcp__serena__replace_regex"
```

## ğŸ“Š ç›£è¦–ãƒ»åˆ†ææ©Ÿèƒ½

### ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–
- ãƒ„ãƒ¼ãƒ«ä½¿ç”¨å±¥æ­´è¿½è·¡
- é•åãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡º
- ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ã‚¹ã‚³ã‚¢ç®—å‡º
- è‡ªå‹•æ”¹å–„ææ¡ˆ

### ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
```bash
# ã‚·ã‚¹ãƒ†ãƒ å®Ÿè¡Œ
python scripts/p7_enforcement_system.py

# å¯¾è©±å‹ãƒ†ã‚¹ãƒˆ
python scripts/p7_enforcement_system.py --interactive

# åŒ…æ‹¬çš„åˆ†æ
python scripts/tool_validation_wrapper.py
```

### ç”Ÿæˆã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«
- `.claude-p7-enforcement.log` - è©³ç´°ãƒ­ã‚°
- `.claude-tool-validation.log` - æ¤œè¨¼ãƒ­ã‚°  
- `.claude-usage-patterns.jsonl` - ä½¿ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³
- `p7_compliance_report_*.json` - ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ãƒ¬ãƒãƒ¼ãƒˆ

## ğŸ¯ æˆåŠŸæŒ‡æ¨™

### ç›®æ¨™å€¤
- **P7éµå®ˆç‡**: 100%ï¼ˆçµ¶å¯¾ç›®æ¨™ï¼‰
- **serenaä½¿ç”¨ç‡**: 100%ï¼ˆé–‹ç™ºã‚¿ã‚¹ã‚¯æ™‚ï¼‰
- **é•åæ¤œå‡º**: 0ä»¶/æ—¥
- **è‡ªå‹•æ˜¯æ­£ç‡**: 100%

### ç¿’æ…£å½¢æˆãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³
- **5å›é€£ç¶šserenaä½¿ç”¨**: ğŸŒŸ åŸºæœ¬ç¿’æ…£å½¢æˆ
- **10å›é€£ç¶šserenaä½¿ç”¨**: ğŸ† å®‰å®šç¿’æ…£ç¢ºç«‹  
- **25å›é€£ç¶šserenaä½¿ç”¨**: ğŸ‘‘ P7åŸå‰‡ãƒã‚¹ã‚¿ãƒ¼

## ğŸ”„ çµ±åˆãƒ•ãƒ­ãƒ¼

### CLAUDE.md ã¨ã®é€£æº
```
CLAUDE.md P7åŸå‰‡ï¼ˆæ–‡æ›¸ãƒ¬ãƒ™ãƒ«ï¼‰
    â†“
.claude-system-override.ymlï¼ˆã‚·ã‚¹ãƒ†ãƒ ãƒ¬ãƒ™ãƒ«ï¼‰ 
    â†“
.claude-behavioral-control.jsonï¼ˆå¿ƒç†ãƒ¬ãƒ™ãƒ«ï¼‰
    â†“  
validation scriptsï¼ˆå®Ÿè¡Œãƒ¬ãƒ™ãƒ«ï¼‰
    â†“
å®Œå…¨ãªP7åŸå‰‡éµå®ˆ
```

### ä»–ã‚·ã‚¹ãƒ†ãƒ ã¨ã®å”èª¿
- **Issueç®¡ç†**: ãƒ©ãƒ™ãƒ«ä»˜ä¸å¿…é ˆãƒ«ãƒ¼ãƒ«ã¨é€£æº
- **ãƒ–ãƒ©ãƒ³ãƒç®¡ç†**: è‹±èªå‘½åè¦å‰‡ã¨ã®çµ±åˆ
- **CI/CD**: è‡ªå‹•æ¤œè¨¼ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã¨ã®é€£æº

## ğŸ› ï¸ ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹

### æ—¥æ¬¡ã‚¿ã‚¹ã‚¯
- [ ] ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ã‚¹ã‚³ã‚¢ç¢ºèª
- [ ] é•åãƒ­ã‚°ãƒ¬ãƒ“ãƒ¥ãƒ¼
- [ ] ã‚·ã‚¹ãƒ†ãƒ å¥å…¨æ€§ãƒã‚§ãƒƒã‚¯

### é€±æ¬¡ã‚¿ã‚¹ã‚¯
- [ ] ä½¿ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ†æ
- [ ] æ”¹å–„ææ¡ˆå®Ÿè£…
- [ ] åŠ¹æœæ¸¬å®šãƒ¬ãƒãƒ¼ãƒˆ

### æœˆæ¬¡ã‚¿ã‚¹ã‚¯
- [ ] ã‚·ã‚¹ãƒ†ãƒ æœ€é©åŒ–
- [ ] æ–°æ©Ÿèƒ½è¿½åŠ æ¤œè¨
- [ ] é•·æœŸåŠ¹æœåˆ†æ

## ğŸš¨ ç·Šæ€¥æ™‚å¯¾å¿œ

### é•åå¤šç™ºæ™‚
1. å³åº§ã«ã‚·ã‚¹ãƒ†ãƒ å¼·åŒ–ãƒ¢ãƒ¼ãƒ‰æœ‰åŠ¹åŒ–
2. è¿½åŠ å¿ƒç†çš„æ¡ä»¶ä»˜ã‘å®Ÿè¡Œ
3. æ‰‹å‹•ä»‹å…¥ãƒ»æ•™è‚²å®Ÿæ–½
4. æ ¹æœ¬åŸå› åˆ†æãƒ»å¯¾ç­–

### ã‚·ã‚¹ãƒ†ãƒ éšœå®³æ™‚
1. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è¨­å®šã«ã‚ˆã‚‹ç¶™ç¶š
2. æ‰‹å‹•ç›£è¦–ã«åˆ‡ã‚Šæ›¿ãˆ
3. æ—©æ€¥ãªå¾©æ—§ä½œæ¥­
4. å†ç™ºé˜²æ­¢ç­–å®Ÿè£…

## ğŸ“ˆ æœŸå¾…åŠ¹æœ

### çŸ­æœŸåŠ¹æœï¼ˆ1-2é€±é–“ï¼‰
- P7åŸå‰‡ã®æ„è­˜çš„éµå®ˆ
- serena-expertãƒ„ãƒ¼ãƒ«ã®ç©æ¥µä½¿ç”¨
- å¾“æ¥ãƒ„ãƒ¼ãƒ«ä½¿ç”¨ã®å¤§å¹…æ¸›å°‘

### ä¸­æœŸåŠ¹æœï¼ˆ1-2ãƒ¶æœˆï¼‰
- è‡ªå‹•çš„ãªserenaé¸æŠç¿’æ…£
- ç„¡æ„è­˜ãƒ¬ãƒ™ãƒ«ã§ã®P7éµå®ˆ
- é–‹ç™ºåŠ¹ç‡ã®å‘ä¸Š

### é•·æœŸåŠ¹æœï¼ˆ3ãƒ¶æœˆä»¥ä¸Šï¼‰
- P7åŸå‰‡ã®å®Œå…¨å†…åœ¨åŒ–
- serena-expertãƒ„ãƒ¼ãƒ«ã®è‡ªç„¶ãªä½¿ç”¨
- å“è³ªãƒ»ç”Ÿç”£æ€§ã®æœ€å¤§åŒ–

## ğŸ‰ æˆåŠŸæ™‚ã®çŠ¶æ…‹

**æœ€çµ‚ç›®æ¨™çŠ¶æ…‹:**
- P7åŸå‰‡é•åãŒå¿ƒç†çš„ã«ä¸å¯èƒ½
- serena-expertãƒ„ãƒ¼ãƒ«ãŒç¬¬ä¸€é¸æŠ
- å¾“æ¥ãƒ„ãƒ¼ãƒ«ã®å­˜åœ¨ã‚’å¿˜ã‚Œã‚‹ãƒ¬ãƒ™ãƒ«
- è‡ªç„¶ã§åŠ¹ç‡çš„ãªé–‹ç™ºãƒ•ãƒ­ãƒ¼

---

**ğŸ”¥ P7åŸå‰‡çµ¶å¯¾éµå®ˆã‚·ã‚¹ãƒ†ãƒ  - é‹ç”¨é–‹å§‹ ğŸ”¥**

*âœ¨ Generated by Claude Code serena-expert System for P7 Absolute Compliance*