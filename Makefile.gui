# Kumihan-Formatter GUI Build Makefile
#
# GUIã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ“ãƒ«ãƒ‰ãƒ»ãƒ†ã‚¹ãƒˆç”¨Makefile

.PHONY: gui-test gui-build-mac gui-build-windows gui-clean gui-install-deps gui-logs gui-logs-tail

# GUIé–¢é€£ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
gui-install-deps:
	@echo "ğŸ“¦ GUIé–¢é€£ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸­..."
	uv add customtkinter pillow tkinterdnd2
	uv add pyinstaller --group dev

# GUIé–‹ç™ºãƒ†ã‚¹ãƒˆèµ·å‹•
gui-test:
	@echo "ğŸ¨ GUIãƒ†ã‚¹ãƒˆèµ·å‹•ä¸­..."
	uv run kumihan-gui

# Macç”¨.appãƒ“ãƒ«ãƒ‰
gui-build-mac:
	@echo "ğŸ Macç”¨.appãƒ“ãƒ«ãƒ‰ä¸­..."
	uv run python3 build/build_mac.py

# Windowsç”¨.exeãƒ“ãƒ«ãƒ‰ï¼ˆWindowsç’°å¢ƒã§ã®ã¿å®Ÿè¡Œï¼‰
gui-build-windows:
	@echo "ğŸªŸ Windowsç”¨.exeãƒ“ãƒ«ãƒ‰ä¸­..."
	@if [ "$(shell uname)" = "Darwin" ]; then \
		echo "âš ï¸  Windowsç”¨ãƒ“ãƒ«ãƒ‰ã¯Windowsç’°å¢ƒã§å®Ÿè¡Œã—ã¦ãã ã•ã„"; \
		exit 1; \
	fi
	uv run python3 build/build_windows.py

# ãƒ“ãƒ«ãƒ‰æˆæœç‰©ã‚’ã‚¯ãƒªã‚¢
gui-clean:
	@echo "ğŸ§¹ ãƒ“ãƒ«ãƒ‰æˆæœç‰©ã‚’ã‚¯ãƒªã‚¢ä¸­..."
	rm -rf dist/
	rm -rf build/Kumihan-Formatter/
	rm -f *.spec

# ã‚¢ãƒ—ãƒªãƒ†ã‚¹ãƒˆèµ·å‹•ï¼ˆMacï¼‰
gui-run-app:
	@echo "ğŸš€ ãƒ“ãƒ«ãƒ‰æ¸ˆã¿ã‚¢ãƒ—ãƒªã‚’èµ·å‹•ä¸­..."
	@if [ -d "dist/Kumihan-Formatter.app" ]; then \
		open dist/Kumihan-Formatter.app; \
	else \
		echo "âŒ ã‚¢ãƒ—ãƒªãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚å…ˆã«gui-build-macã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„"; \
	fi

# çµ±åˆãƒ“ãƒ«ãƒ‰ãƒ»ãƒ†ã‚¹ãƒˆ
gui-full-build: gui-clean gui-build-mac
	@echo "âœ… GUIå®Œå…¨ãƒ“ãƒ«ãƒ‰å®Œäº†ï¼"
	@echo "ğŸ“± ã‚¢ãƒ—ãƒªã‚µã‚¤ã‚º: $(shell du -sh dist/Kumihan-Formatter.app | cut -f1)"
	@echo "ğŸ¯ ãƒ†ã‚¹ãƒˆ: make gui-run-app"

# ãƒ­ã‚°ç¢ºèª
gui-logs:
	@echo "ğŸ” GUIãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ç¢ºèªä¸­..."
	python3 scripts/check_gui_logs.py

# ãƒ­ã‚°ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–
gui-logs-tail:
	@echo "ğŸ‘€ GUIãƒ­ã‚°ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–é–‹å§‹..."
	python3 scripts/check_gui_logs.py tail

# ãƒ˜ãƒ«ãƒ—
gui-help:
	@echo "ğŸ¨ Kumihan-Formatter GUI ãƒ“ãƒ«ãƒ‰ã‚³ãƒãƒ³ãƒ‰:"
	@echo ""
	@echo "  gui-install-deps  ğŸ“¦ GUIä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«"
	@echo "  gui-test         ğŸ¨ é–‹ç™ºç’°å¢ƒã§GUIãƒ†ã‚¹ãƒˆèµ·å‹•"
	@echo "  gui-build-mac    ğŸ Macç”¨.appãƒ“ãƒ«ãƒ‰"
	@echo "  gui-build-windows ğŸªŸ Windowsç”¨.exeãƒ“ãƒ«ãƒ‰"
	@echo "  gui-run-app      ğŸš€ ãƒ“ãƒ«ãƒ‰æ¸ˆã¿ã‚¢ãƒ—ãƒªèµ·å‹•"
	@echo "  gui-clean        ğŸ§¹ ãƒ“ãƒ«ãƒ‰æˆæœç‰©ã‚¯ãƒªã‚¢"
	@echo "  gui-full-build   âœ… å®Œå…¨ãƒ“ãƒ«ãƒ‰ï¼ˆã‚¯ãƒªã‚¢â†’ãƒ“ãƒ«ãƒ‰ï¼‰"
	@echo "  gui-logs         ğŸ” ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ç¢ºèª"
	@echo "  gui-logs-tail    ğŸ‘€ ãƒ­ã‚°ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–"
	@echo ""