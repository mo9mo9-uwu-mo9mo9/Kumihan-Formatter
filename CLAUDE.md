# CLAUDE.md

> **本ドキュメントは Claude Code (claude.ai/code) に本リポジトリの開発ガイドラインを日本語で伝えるためのものです。**
>
> プロジェクト名: **Kumihan-Formatter**  
> バージョン: 0.1.0 (CLI プロトタイプ)

@SPEC.md
@CONTRIBUTING.md

---

## 1 📖 ツール概要

Kumihan-Formatter は **CoC6th 同人シナリオ** などのテキストファイル（.txt）を、*ワンコマンドで配布可能な HTML* に自動組版する **クロスプラットフォーム CLI ツール** です。

### 🎯 ターゲットユーザー
- **メインユーザー**: 開発知識を一切持たない同人作家
- **対象**: 組版知識・ツール経験なしでも作品を形にしたい方
- **対象外**: 企業・技術者・開発者向けではない

GUI は提供せず、Python 3.9 以上が導入されている **Windows / macOS** で動作します。

主なユーザーストーリー:

| # | ストーリー | 価値 |
|:-:|-------------------------|-------------|
| 1 | シナリオ作者は素の .txt を読み込ませたい | 面倒な組版作業から解放される |
| 2 | HTML 形式をワンコマンドで出力したい | 即売会・Booth でそのまま配布可能 |
| 3 | CSS を触らずに見栄えを整えたい | デザイン知識不要で品質確保 |
| 4 | batファイルをダブルクリックして変換したい | コマンドライン知識不要 |
| 5 | D&D操作で簡単に変換したい | 直感的な操作で高速化 |

### 🖥️ 基本操作方法
- **基本操作**: batファイル/commandファイルのダブルクリック → D&D変換・対話形式
- **上級操作**: ターミナルでのコマンド利用（優先度低）

---

## 2 🗺️ ロードマップ（ハイレベル）

| マイルストーン | 範囲 | 予定 |
|-----------|-------|------|
| **M0 – 初期セットアップ** | リポジトリ骨組み、Poetry/venv、CI | *完了* |
| **M1 – パーサ & HTML レンダラ** | 基本機能実装 | *完了* |
| **M2 – UX 改善** | ライブプレビュー、エラーハイライト | *完了* |
| **M3 – 拡張フック** | YAML/JSON 設定、テーマ切替 | *完了* |
| **M4 – ドキュメント整備** | READMEのHTML化、ユーザーガイド作成 | 進行中 |
| **M5 – 配布機能** | ZIP配布、バッチファイル整備 | 計画中 |
| **M6 – UI改善** | D&D対応、直感的操作 | 計画中 |
| **M7 – 正式版準備** | バグ修正、テスト強化、フィードバック反映 | 計画中 |
| **M8 – 追加出力** | PDF 出力、EPUB 出力 | バックログ |

> **スプリント長** : 1 週間（ソロ開発）

### 🏷️ バージョニング戦略

#### セマンティックバージョニング採用
**MAJOR.MINOR.PATCH** 形式でバージョン管理を行います。

| バージョン | マイルストーン | 内容 | 備考 |
|-----------|-------------|------|------|
| **0.1.0** | M1-M3完了 | 基本機能実装 | *現在* |
| **0.2.0** | M4完了 | ドキュメント整備 | 配布準備の基盤 |
| **0.3.0** | M5完了 | 配布機能 | ユーザーが受け取れる形 |
| **0.4.0** | M6完了 | UI改善 | 初心者でも使える形 |
| **0.9.0** | M7完了 | 正式版準備 | バグ修正・テスト強化 |
| **0.9.x** | - | フィードバック反映 | 品質向上イテレーション |
| **1.0.0** | - | 初回正式リリース | **人様に渡せる品質** |

#### バージョン管理ツール
- **bumpversion**: pyproject.tomlで自動バージョン更新・タグ作成
- **Git タグ**: `v0.2.0` 形式でリリースポイントを管理

---

## 3 🎲 製品戦略

### 3.1 開発段階
1. **第1段階**: CoC6th専用ツールとして完成
2. **第2段階**: TRPG汎用組版ツールへ拡大

### 3.2 配布・ライセンス方針
- **改変**: 自由に許可
- **再配布**: 禁止
- **基本方針**: 個人利用に特化
- **開発体制**: 個人開発、マネタイズなし

### 3.3 UI/UX 設計方針
- **GUI化・WEB化**: コスト重でCLI維持
- **複雑化回避**: 基本機能で十分使えることを重視

---

## 4 🚨 **絶対に守るべき禁止事項**

### 🔒 **ファイル削除の絶対禁止**
以下のファイル・フォルダは **絶対に削除してはならない**：

1. **CLAUDE.md** - 本ファイル（プロジェクトの仕様書・指示書）
   - `rm`、`git rm`、その他あらゆる削除操作禁止
   - Claude Code の動作を制御する重要ファイル

2. **.claude/ フォルダ内の全ファイル** - Claude Code設定フォルダ
   - `settings.local.json` などの設定ファイル
   - Claude Code自身の権限管理ファイル
   - 削除すると機能に重大な影響

### 🚫 **GitHubアップロード禁止**
Claude Code関連の設定ファイルはGitHubにアップロードしてはならない：
- `.claude/settings.local.json`
- その他 `.claude/` フォルダ内のファイル
- `.gitignore` で除外済み、追跡から外すこと

### ⚠️ **違反時の対応**
これらの禁止事項に違反した場合：
1. 即座に作業を停止
2. 可能な限り復元を試行
3. 同様の問題を防ぐ対策を実施

### 📋 **遵守チェックリスト**
- [ ] `rm` コマンド使用前に削除対象を確認
- [ ] `git rm` 実行前に対象ファイルを確認  
- [ ] コミット前に `.claude/` 関連ファイルが含まれていないか確認
- [ ] CLAUDE.md の変更は追記のみ、削除は禁止

---

## 5 📝 **追加指示・学習事項**

### 🎯 **今後の方針**
- プルリクエストワークフローの徹底
- 重要ファイルの保護意識の向上
- 丁寧なファイル操作の実行

### 📋 **開発ガイドライン**
- **シンプルさを優先**: 基本機能で十分使えることを重視
- **設定ファイルは上級者向け**: JSON/YAML設定は表に出さず、「カスタマイズも可能」程度の言及に留める
- **初心者に優しいUI**: 複雑な機能は隠し、基本的な使い方を前面に出す
- **ドキュメントの階層化**: 基本→応用→上級者向けの順で情報を整理
- **UIの複雑化を避ける**: 設定項目の増加より、使いやすさを優先
- **機能の段階的開示**: 初心者が圧倒されないよう、段階的に機能を紹介

### 📅 **更新履歴**
- 2025-06-23: CLAUDE.md構造改善（Issue #52）
  - 430行・19KBの肥大化ファイルを3分割
  - SPEC.md: フォーマット仕様（140行→60行に簡素化）
  - CONTRIBUTING.md: 開発ガイド・ラベリングルール
  - CLAUDE.md: Claude Code指示のコア情報のみ
  - @インポート機能で保守性・可読性を大幅改善
- 2025-06-22: GitHub Issueラベリングルール策定・フォーマット記号仕様変更
- 2025-06-22: 開発戦略明確化・配布戦略拡張（M4開始）
- 2025-01-21: v0.1.0 リリース完了・開発方針更新

---

開発を楽しみましょう！ 🎉