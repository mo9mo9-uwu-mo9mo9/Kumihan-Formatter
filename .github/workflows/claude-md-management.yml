name: CLAUDE.md Basic Management

# Issue #1119: CLAUDE.md管理の簡素化版
# 複雑な分析機能を削除し、基本チェックのみに集約

on:
  pull_request:
    paths:
      - 'CLAUDE.md'
  push:
    branches:
      - main
    paths:
      - 'CLAUDE.md'

# 同時実行制御
concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

jobs:
  claude-md-basic-check:
    runs-on: ubuntu-latest
    name: CLAUDE.md Basic Size Check

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Basic Size Check
        run: |
          if [ ! -f "CLAUDE.md" ]; then
            echo "❌ CLAUDE.md not found"
            exit 1
          fi

          # 基本的なサイズチェックのみ
          SIZE=$(wc -c < CLAUDE.md)
          LINES=$(wc -l < CLAUDE.md)
          SIZE_KB=$(( SIZE / 1024 ))

          echo "📊 CLAUDE.md Statistics:"
          echo "   Lines: $LINES"
          echo "   Size: $SIZE bytes (${SIZE_KB}KB)"

          # 簡素化された閾値チェック（Issue要件：複雑な分析削除）
          if [ $SIZE -gt 15000 ] || [ $LINES -gt 300 ]; then
            echo "⚠️  WARNING: CLAUDE.md is large"
            echo "   Size: $SIZE bytes (limit: 15000)"
            echo "   Lines: $LINES (limit: 300)"
            echo "   Consider simplifying content"
          else
            echo "✅ CLAUDE.md size is within acceptable limits"
          fi

          # 必須セクション存在チェック（簡略版）
          if grep -q "プロジェクト概要" CLAUDE.md && \
             grep -q "開発原則" CLAUDE.md && \
             grep -q "コーディング標準" CLAUDE.md; then
            echo "✅ Required sections found"
          else
            echo "⚠️  Some required sections may be missing"
          fi
