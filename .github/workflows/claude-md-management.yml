name: CLAUDE.md Basic Management

# Issue #1119: CLAUDE.mdç®¡ç†ã®ç°¡ç´ åŒ–ç‰ˆ
# è¤‡é›‘ãªåˆ†ææ©Ÿèƒ½ã‚’å‰Šé™¤ã—ã€åŸºæœ¬ãƒã‚§ãƒƒã‚¯ã®ã¿ã«é›†ç´„

on:
  pull_request:
    paths:
      - 'CLAUDE.md'
  push:
    branches:
      - main
    paths:
      - 'CLAUDE.md'

# åŒæ™‚å®Ÿè¡Œåˆ¶å¾¡
concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

jobs:
  claude-md-basic-check:
    runs-on: ubuntu-latest
    name: CLAUDE.md Basic Size Check

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Basic Size Check
        run: |
          if [ ! -f "CLAUDE.md" ]; then
            echo "âŒ CLAUDE.md not found"
            exit 1
          fi

          # åŸºæœ¬çš„ãªã‚µã‚¤ã‚ºãƒã‚§ãƒƒã‚¯ã®ã¿
          SIZE=$(wc -c < CLAUDE.md)
          LINES=$(wc -l < CLAUDE.md)
          SIZE_KB=$(( SIZE / 1024 ))

          echo "ğŸ“Š CLAUDE.md Statistics:"
          echo "   Lines: $LINES"
          echo "   Size: $SIZE bytes (${SIZE_KB}KB)"

          # ç°¡ç´ åŒ–ã•ã‚ŒãŸé–¾å€¤ãƒã‚§ãƒƒã‚¯ï¼ˆIssueè¦ä»¶ï¼šè¤‡é›‘ãªåˆ†æå‰Šé™¤ï¼‰
          if [ $SIZE -gt 15000 ] || [ $LINES -gt 300 ]; then
            echo "âš ï¸  WARNING: CLAUDE.md is large"
            echo "   Size: $SIZE bytes (limit: 15000)"
            echo "   Lines: $LINES (limit: 300)"
            echo "   Consider simplifying content"
          else
            echo "âœ… CLAUDE.md size is within acceptable limits"
          fi

          # å¿…é ˆã‚»ã‚¯ã‚·ãƒ§ãƒ³å­˜åœ¨ãƒã‚§ãƒƒã‚¯ï¼ˆç°¡ç•¥ç‰ˆï¼‰
          if grep -q "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦" CLAUDE.md && \
             grep -q "é–‹ç™ºåŸå‰‡" CLAUDE.md && \
             grep -q "ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°æ¨™æº–" CLAUDE.md; then
            echo "âœ… Required sections found"
          else
            echo "âš ï¸  Some required sections may be missing"
          fi
